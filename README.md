# GPz
Non-stationary sparse Gaussian processes for heteroscedastic uncertainty estimation

## Introduction
This is a Matlab and a python implementations of the methods described in [Almosallam el al.](https://arxiv.org/abs/1604.03593) for non-stationary sparse Gaussian processes with heteroscedastic noise. The model optimizes the probability of the data being generated by a linear combination of radial basis functions (RBF) with the following options:

  - **Global length-scale (GL)**: All the basis functions share the same length scale.
  - **Variable length-scale (VL)**: Each basis has a specific length-scale.
  - **Global Diagonal (GD)**: All the basis functions share the same diagonal covariance.
  - **Variable Diagonal (VD)**: Each basis has a specific diagonal covariance.
  - **Global Covariance (GC)**: All the basis functions share the same full covariance.
  - **Variable Covariance (VC)**: Each basis has a specific full covariance.
  - **Artificial Neural Networks (ANN)**: Multilayer Neural Network.

### Joint Linear Prior Optimization
The models allows for an optional linear prior optimization as descried in [Almosallamet et al. 2016](https://mnras.oxfordjournals.org/content/455/3/2387.abstract?related-urls=yes&legid=mnras;455/3/2387), i.e. the prior mean on the generative function is a linear combination of the raw input instead of a constant or simply zero. This has the effect that in extrapolation regions, the model will fall back to the general linear trend the data rather than falling back to zero.

### Cost Sensitive learning
The model allows for a supplementary input vector to weigh samples differently during optimization. For example, the weights of the samples can be assigned according to their frequency to weigh outliers more aggressively. There are three built-in options available:

  - **normal**: All samples are equally important 
  - **balanced**: Groups the samples into bins of width ‘binWidth’ and assigns a weight to each sample that is the reciprocal of its frequency in its bin
  - **normalized**: This is a photo-z specific weighting scheme that weighs each sample according to its spectroscopic redshift as 1/(1+z)

### Heterosccedastic Noise
This option allows for input-dependent noise estimation. The noise process is also modeled as a linear combination of the basis functions. If disabled, the model assumed a global Gaussian noise variance. If only interested in point estimates, this feature can be disabled to speedup the optimization process and to minimize the number of basis functions required

## Getting Started

### Requirements
#### Matlab:

Download the [minFunc](https://www.cs.ubc.ca/~schmidtm/Software/minFunc_2012.zip) optimization package 

#### Python:

  - **scipy**
  - **numpy**
  - **matplotlib**
  - **sklearn**

To install, type the following in the command line:
```bash
pip install package_name
```

### Running:

There are two starter codes available:

  - **demo_sin**: A simple univariate example using all the default options with minimal configuration
  - **demo_photoz**: A more advanced script showing how to configure all available options on a photo-z sample
